[mysqld_safe]
log_error = /var/log/mysql/error.log

[mysqld]
log_error = /var/log/mysql/error.log

<% if @slow_query_log_file && @long_query_time %>
# Enable the slow query log to see queries with especially long duration
slow_query_log         = on
slow_query_log_file    = <%= @slow_query_log_file %>
long_query_time        = <%= @long_query_time %>
#log_slow_rate_limit    = 1000
#log_slow_verbosity     = query_plan
#log-queries-not-using-indexes
<% end %>

# c.f. https://docs.datadoghq.com/ja/database_monitoring/setup_mysql/selfhosted/
<% if @mysql_short_version >= 5.7 %>
performance_schema = ON
max_digest_length  = 4096
performance_schema_max_digest_length   = 4096

# NOTE: MariaDBだとエラーになるのでコメントアウト
# performance_schema_max_sql_text_length = 4096

performance-schema-consumer-events-statements-current      = ON
performance-schema-consumer-events-statements-history-long = ON
performance-schema-consumer-events-statements-history      = ON
<% end %>
