xbuild:
  path: "/home/isucon/xbuild"

ruby:
  # version: 3.2.0-dev
  version: 3.1.2
  enabled_yjit: true

gem:
  install:
    # NOTE: Ruby 3.1だとbundlerでwarningが出るため最新を入れる    
    # c.f. https://github.com/rubygems/rubygems/issues/5234
    bundler: 2.3.9

rust:
  # Ruby 3.2.0devでYJITを有効にしてビルドするには1.60.0以上が必要
  # c.f. https://koic.hatenablog.com/entry/building-rust-yjit
  version: 1.60.0

git_global_config:
  user.email: "sue445@sue445.net"
  user.name:  "sue445"

packages:
  - git
  - wget
  - htop
  - tmux
  - tig
  - redis-server
  - memcached

services:
  # この言語の参照実装のみ有効化する
  active_language: ruby

  # NOTE: active_languageが効かない場合は `sudo systemctl list-unit-files --type=service | grep isu` などで調べる
  enabled:
    # isucon11-qualify
    # - isucondition.ruby.service
  disabled:
    # isucon11-qualify
    # - isucondition.go.service
    # - isucondition.nodejs.service
    # - isucondition.perl.service
    # - isucondition.php.service
    # - isucondition.python.service
    # - isucondition.rust.service

    # インストールはするが実際に使うまでサービスは止めておく
    - redis-server

datadog:
  # NOTE: api_keyは.envからセットする
  # api_key: xxxxxx

  install_only: false
  upgrade: false
  agent_major_version: 7

  integrations:
    datadog-puma: 1.1.0 # https://github.com/DataDog/integrations-extras/blob/master/puma/CHANGELOG.md

mysql:
  users:
    - user: isucon
      host: "%"
      password: isucon

  slow_query_log_file: /var/log/mysql/slow.log
  long_query_time: 0

puma:
  control_url:   http://127.0.0.1:9293
  control_token: datadog
